mscale:  1.0
freqs shape:  torch.Size([8192, 80])
freqs:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0000e+00, 8.7894e-01, 7.7254e-01,  ..., 4.8413e-05, 4.2552e-05,
         3.7401e-05],
        [2.0000e+00, 1.7579e+00, 1.5451e+00,  ..., 9.6825e-05, 8.5104e-05,
         7.4801e-05],
        ...,
        [8.1890e+03, 7.1977e+03, 6.3263e+03,  ..., 3.9645e-01, 3.4846e-01,
         3.0627e-01],
        [8.1900e+03, 7.1985e+03, 6.3271e+03,  ..., 3.9650e-01, 3.4850e-01,
         3.0631e-01],
        [8.1910e+03, 7.1994e+03, 6.3279e+03,  ..., 3.9655e-01, 3.4854e-01,
         3.0635e-01]])
cos shape:  torch.Size([8192, 1, 160])
sin shape:  torch.Size([8192, 1, 160])
cos:  tensor([[[ 1.0000,  1.0000,  1.0000,  ...,  1.0000,  1.0000,  1.0000]],

        [[ 0.5405,  0.6382,  0.7163,  ...,  1.0000,  1.0000,  1.0000]],

        [[-0.4163, -0.1860,  0.0257,  ...,  1.0000,  1.0000,  1.0000]],

        ...,

        [[-0.4248, -0.9634,  0.6694,  ...,  0.9224,  0.9399,  0.9536]],

        [[-0.9912, -0.4082,  0.9980,  ...,  0.9224,  0.9399,  0.9536]],

        [[-0.6465,  0.4426,  0.7598,  ...,  0.9224,  0.9399,  0.9536]]],
       dtype=torch.float16)
sin:  tensor([[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
           0.0000e+00,  0.0000e+00]],

        [[ 8.4131e-01,  7.7002e-01,  6.9775e-01,  ...,  4.8399e-05,
           4.2558e-05,  3.7372e-05]],

        [[ 9.0918e-01,  9.8242e-01,  9.9951e-01,  ...,  9.6798e-05,
           8.5115e-05,  7.4804e-05]],

        ...,

        [[ 9.0527e-01, -2.6807e-01, -7.4268e-01,  ...,  3.8623e-01,
           3.4155e-01,  3.0151e-01]],

        [[ 1.3171e-01, -9.1309e-01, -6.4514e-02,  ...,  3.8623e-01,
           3.4155e-01,  3.0151e-01]],

        [[-7.6318e-01, -8.9697e-01,  6.5039e-01,  ...,  3.8623e-01,
           3.4155e-01,  3.0151e-01]]], dtype=torch.float16)
RotaryEmbedding passed
